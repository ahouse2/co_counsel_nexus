INFO:     Started server process [1]
Initializing QdrantClient. URL: http://qdrant:6333, Path: None
Connecting to Qdrant at http://qdrant:6333
INFO:     172.18.0.1:37966 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.1:37980 - "POST /api/documents/upload?case_id=intelligence_test_case&doc_type=my_documents HTTP/1.1" 200 OK
INFO:     Waiting for application startup.
HTTP Request: GET http://qdrant:6333 "HTTP/1.1 200 OK"
HTTP Request: GET http://qdrant:6333/collections/cocounsel_documents "HTTP/1.1 200 OK"
Received notification from DBMS server: {severity: INFORMATION} {code: Neo.ClientNotification.Schema.IndexOrConstraintAlreadyExists} {category: SCHEMA} {title: `CREATE CONSTRAINT document_id IF NOT EXISTS FOR (e:Document) REQUIRE (e.id) IS UNIQUE` has no effect.} {description: `CONSTRAINT document_id FOR (e:Document) REQUIRE (e.id) IS UNIQUE` already exists.} {position: None} for query: 'CREATE CONSTRAINT document_id IF NOT EXISTS FOR (d:Document) REQUIRE d.id IS UNIQUE'
Received notification from DBMS server: {severity: INFORMATION} {code: Neo.ClientNotification.Schema.IndexOrConstraintAlreadyExists} {category: SCHEMA} {title: `CREATE CONSTRAINT entity_id IF NOT EXISTS FOR (e:Entity) REQUIRE (e.id) IS UNIQUE` has no effect.} {description: `CONSTRAINT entity_id FOR (e:Entity) REQUIRE (e.id) IS UNIQUE` already exists.} {position: None} for query: 'CREATE CONSTRAINT entity_id IF NOT EXISTS FOR (e:Entity) REQUIRE e.id IS UNIQUE'
HTTP Request: GET http://qdrant:6333 "HTTP/1.1 200 OK"
HTTP Request: GET http://qdrant:6333/collections/cocounsel_documents/exists "HTTP/1.1 200 OK"
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
Starting ingestion for doc_id=f9b314dc-7f12-4097-810b-2319eb4a0a1f, origin=upload
Updating status to 'processing' for doc_id=f9b314dc-7f12-4097-810b-2319eb4a0a1f
Running ingestion pipeline for doc_id=f9b314dc-7f12-4097-810b-2319eb4a0a1f, file=/var/cocounsel/materialized/f9b314dc-7f12-4097-810b-2319eb4a0a1f/timeline_test.txt
Ingestion pipeline started. Cost mode: pro
Loaded 1 documents for job f9b314dc-7f12-4097-810b-2319eb4a0a1f
INFO:     172.18.0.1:37988 - "GET /api/timeline/intelligence_test_case HTTP/1.1" 200 OK
Failed to build graph index: No module named 'llama_index.graph_stores'
INFO:     172.18.0.1:38000 - "GET /api/timeline/intelligence_test_case HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:48866 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.1:37728 - "GET /api/timeline/intelligence_test_case HTTP/1.1" 500 Internal Server Error
INFO:     172.18.0.1:47224 - "GET /api/timeline/intelligence_test_case HTTP/1.1" 500 Internal Server Error
INFO:     172.18.0.1:47238 - "GET /api/timeline/intelligence_test_case HTTP/1.1" 500 Internal Server Error
INFO:     172.18.0.1:39024 - "GET /api/timeline/intelligence_test_case HTTP/1.1" 500 Internal Server Error
INFO:     172.18.0.1:39030 - "GET /api/timeline/intelligence_test_case HTTP/1.1" 500 Internal Server Error
INFO:     172.18.0.1:46272 - "GET /api/timeline/intelligence_test_case HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:55704 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.1:46276 - "GET /api/timeline/intelligence_test_case HTTP/1.1" 500 Internal Server Error
INFO:     172.18.0.1:54804 - "GET /api/timeline/intelligence_test_case HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:53322 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:33708 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:39340 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:44914 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:42396 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:41902 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:43990 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:44388 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:53408 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:37646 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:56090 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:43362 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:36936 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:43062 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:43782 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:39882 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:33226 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:54240 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:40464 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:45020 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:35164 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:48850 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:43582 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:37536 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:58124 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:46194 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:55136 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:36632 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:48552 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:58666 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:51688 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57662 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:41258 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:35694 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:43738 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:56220 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:44574 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:56520 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:34910 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:42662 - "GET /health HTTP/1.1" 200 OK
HTTP Request: GET http://qdrant:6333 "HTTP/1.1 200 OK"
HTTP Request: GET http://qdrant:6333/collections/cocounsel_documents/exists "HTTP/1.1 200 OK"
Running IngestionPipeline with transformations: [SentenceSplitter(include_metadata=True, include_prev_next_rel=True, callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x70f0dbd3de90>, id_func=<function default_id_func at 0x70f0f734d260>, chunk_size=400, chunk_overlap=60, separator=' ', paragraph_separator='\n\n\n', secondary_chunking_regex='[^,.;πÇé∩╝ƒ∩╝ü]+[,.;πÇé∩╝ƒ∩╝ü]?'), LocalHuggingFaceEmbedding(model_name='sentence-transformers/all-MiniLM-L6-v2', embed_batch_size=10, callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x70f0e1557690>, num_workers=None, dimensions=384)]
HTTP Request: GET http://qdrant:6333/collections/cocounsel_documents/exists "HTTP/1.1 200 OK"
HTTP Request: GET http://qdrant:6333/collections/cocounsel_documents "HTTP/1.1 200 OK"
HTTP Request: PUT http://qdrant:6333/collections/cocounsel_documents/points?wait=true "HTTP/1.1 200 OK"
IngestionPipeline finished. Processed 1 nodes.
Error in custom analysis for /var/cocounsel/materialized/f9b314dc-7f12-4097-810b-2319eb4a0a1f/timeline_test.txt: cannot import name 'SelectorResult' from 'llama_index.core.selectors' (/opt/venv/lib/python3.11/site-packages/llama_index/core/selectors/__init__.py)
Traceback (most recent call last):
  File "/src/backend/ingestion/pipeline.py", line 277, in run_ingestion_pipeline
    from backend.app.services.classification_service import ClassificationService
  File "/src/backend/app/services/classification_service.py", line 5, in <module>
    from llama_index.core.selectors import LLMMultiSelector, SelectorResult
ImportError: cannot import name 'SelectorResult' from 'llama_index.core.selectors' (/opt/venv/lib/python3.11/site-packages/llama_index/core/selectors/__init__.py)
Starting Graph Indexing for 1 documents...
Graph Indexing failed: No module named 'llama_index.graph_stores'
Traceback (most recent call last):
  File "/src/backend/ingestion/pipeline.py", line 381, in run_ingestion_pipeline
    kg_service.build_graph_index(llama_documents, case_id=source.metadata.get("case_id"))
  File "/src/backend/app/services/knowledge_graph_service.py", line 528, in build_graph_index
    raise e
  File "/src/backend/app/services/knowledge_graph_service.py", line 464, in build_graph_index
    from llama_index.graph_stores.neo4j import Neo4jGraphStore
ModuleNotFoundError: No module named 'llama_index.graph_stores'
Ingestion completed successfully for doc_id=f9b314dc-7f12-4097-810b-2319eb4a0a1f
IntelligenceService triggered for doc f9b314dc-7f12-4097-810b-2319eb4a0a1f in case intelligence_test_case
Running TimelineAgent for f9b314dc-7f12-4097-810b-2319eb4a0a1f
Extracted 3 events from f9b314dc-7f12-4097-810b-2319eb4a0a1f
Could not parse date '' for event in f9b314dc-7f12-4097-810b-2319eb4a0a1f. Using now.
Could not parse date '' for event in f9b314dc-7f12-4097-810b-2319eb4a0a1f. Using now.
Could not parse date '' for event in f9b314dc-7f12-4097-810b-2319eb4a0a1f. Using now.
INFO:     127.0.0.1:51788 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:33184 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:33192 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:38662 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:51908 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:53568 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:54602 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:33152 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:58852 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:43110 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:39730 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:46532 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:34282 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:41860 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:59130 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:47072 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:43302 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:34062 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:48608 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:56162 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:40382 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:41184 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:38106 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:35142 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:51788 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57282 - "GET /health HTTP/1.1" 200 OK
